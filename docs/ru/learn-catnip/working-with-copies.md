# Работа с копиями

::: note Автоматически переведённая страница
К сожалению, на полный ручной перевод у нас не хватает ресурсов.
Если вы увидели ошибку — отправьте пул-риквест с исправлениями (ссылка для редактирования в конце страницы).
:::

Часто при разработке логики игры вам нужно будет найти и изменить копию события другой копии. Catnip предоставляет несколько способов для этого.

## Изменение групп копий

Чтобы повлиять на все копии конкретной шаблон-страницы, вы можете использовать блок под названием "С всеми копиями шаблона". Внутри этого блока любые команды, которые ранее влияли на копию вашего события, теперь будут влиять на копии выбранного шаблона.

<catnip-block class=" command void   selected">  <img src="/assets/icons/template.svg" class="feather"><span class="catnip-block-aTextLabel">With all copies of a template</span>          <span class="catnip-block-aConstantInput menu string ">   <img src="/assets/icons/image.svg" class="feather"><span>Slime</span></span>       <div class="catnip-block-Blocks"> <catnip-block-list>   <catnip-block class=" command    ">  <img src="/assets/icons/template.svg" class="feather"><span class="catnip-block-aTextLabel">Destroy this copy</span>     </catnip-block>    </catnip-block-list> </div>        </catnip-block>

Аналогичный блок существует для влияния на все копии в текущей комнате: "Для каждой копии".

::: warning
Свойства также читают и записывают значения в манипулируемые копии. Если вы хотите передать данные из основной копии в те, на которые вы влияете, используйте переменные.
:::

## Изменение конкретных копий

Чтобы изменить конкретную копию, можно использовать несколько блоков: "с копией", "считать свойство X" и "задать свойство X". Но сначала вам нужна **ссылка** на копию, которую вы хотите изменить. Ссылки являются обычными переменными и свойствами, которые указывают на сложные структуры, и копии являются одним из примеров таких структур. Ссылки отличаются от строковых, числовых и логических значений: когда вы копируете значение из одной строковой переменной в другую, изменение одной переменной не влияет на другую. При работе со ссылками ничего не дублируется, и вы по-прежнему работаете с одним объектом, даже если у вас несколько ссылок на него.

### Получение копии конкретной шаблона

В вычисляемом блоке "templates list" Catnip есть функция, которая возвращает массив всех копий заданного вами шаблона. С помощью блоков из категории Массивы вы можете получить ссылку на любую копию в этом массиве. Это может быть использовано для получения копии вашего героя или списка всех мобов в комнате. Вы можете извлечь значения этого массива с помощью блоков из категории Массивы.

Обратите внимание, что получение элемента из этого массива может ничего не вернуть, если в комнате нет копий заданного шаблона или вы выбираете элемент по индексу, который превышает размер массива. Из-за этого вам всегда нужно добавлять условия, которые проверяют, является ли полученное значение действительной копией. Также помните, что индексация массивов начинается с 0, а не с 1.

#### Пример: Найти героя и двигаться к нему

<catnip-block class=" command    selected">  <img src="/assets/icons/code-alt.svg" class="feather"><span class="catnip-block-aTextLabel">Set</span>         <catnip-block class=" computed wildcard wildcard userdefined ">  <img src="/assets/icons/archive.svg" class="feather"> <span class="catnip-block-aTextLabel">hero</span>              </catnip-block>  <span class="catnip-block-aTextLabel">value</span>                  <catnip-block class=" computed wildcard wildcard  ">  <img src="/assets/icons/grid.svg" class="feather"><span class="catnip-block-aTextLabel">get array element</span>         <catnip-block class=" computed wildcard wildcard  ">  <img src="/assets/icons/template.svg" class="feather"><span class="catnip-block-aTextLabel">templates list</span>          <span class="catnip-block-aConstantInput menu wildcard ">   <img src="/assets/icons/image.svg" class="feather"><span>Cat</span></span>     </catnip-block>  <span class="catnip-block-aTextLabel">at</span>                   <input type="text" class="catnip-block-aConstantInput number " style=" width: 1.5ch;    " value="0" readonly="readonly">     </catnip-block>      </catnip-block>
<catnip-block class=" command    selected">  <img src="/assets/icons/help-circle.svg" class="feather"><span class="catnip-block-aTextLabel">If</span>         <catnip-block class=" computed boolean boolean  ">  <img src="/assets/icons/template.svg" class="feather"><span class="catnip-block-aTextLabel">is valid</span>         <catnip-block class=" computed wildcard wildcard userdefined ">  <img src="/assets/icons/archive.svg" class="feather"> <span class="catnip-block-aTextLabel">hero</span>              </catnip-block>      </catnip-block>        <div class="catnip-block-Blocks"> <catnip-block-list>   <catnip-block class=" command    ">  <img src="/assets/icons/move.svg" class="feather"><span class="catnip-block-aTextLabel">Set direction to</span>         <catnip-block class=" computed number number  ">  <img src="/assets/icons/tool.svg" class="feather"><span class="catnip-block-aTextLabel">2-point direction</span>         <catnip-block class=" computed number number  ">  <img src="/assets/icons/move.svg" class="feather"><span class="catnip-block-aTextLabel">x</span>     </catnip-block>          <catnip-block class=" computed number number  ">  <img src="/assets/icons/move.svg" class="feather"><span class="catnip-block-aTextLabel">y</span>     </catnip-block>          <catnip-block class=" computed number number  ">  <img src="/assets/icons/move.svg" class="feather"><span class="catnip-block-aTextLabel">x of</span>         <catnip-block class=" computed wildcard wildcard userdefined ">  <img src="/assets/icons/archive.svg" class="feather"> <span class="catnip-block-aTextLabel">hero</span>              </catnip-block>      </catnip-block>          <catnip-block class=" computed number number  ">  <img src="/assets/icons/move.svg" class="feather"><span class="catnip-block-aTextLabel">y of</span>         <catnip-block class=" computed wildcard wildcard userdefined ">  <img src="/assets/icons/archive.svg" class="feather"> <span class="catnip-block-aTextLabel">hero</span>              </catnip-block>      </catnip-block>      </catnip-block>      </catnip-block>   <catnip-block class=" command    ">  <img src="/assets/icons/move.svg" class="feather"><span class="catnip-block-aTextLabel">Move this copy</span>     </catnip-block>    </catnip-block-list> </div>        </catnip-block>

### Изменение копий, созданных программно

При создании копии вы можете сохранить ссылку на нее в переменную с помощью правой ячейки "сохранить в X". Классический случай использования — создание снаряда и настройка его параметров.

<catnip-block class=" command    selected">  <img src="/assets/icons/template.svg" class="feather"><span class="catnip-block-aTextLabel">Copy a template</span>          <span class="catnip-block-aConstantInput menu string ">   <img src="/assets/icons/image.svg" class="feather"><span>Bullet</span></span>         <catnip-block class=" computed number number  ">  <img src="/assets/icons/move.svg" class="feather"><span class="catnip-block-aTextLabel">x</span>     </catnip-block>          <catnip-block class=" computed number number  ">  <img src="/assets/icons/move.svg" class="feather"><span class="catnip-block-aTextLabel">y</span>     </catnip-block>    <div class="catnip-block-aFiller"></div>        <span class="catnip-block-aTextLabel">store in</span>                  <catnip-block class=" computed wildcard wildcard userdefined ">  <img src="/assets/icons/clock.svg" class="feather"> <span class="catnip-block-aTextLabel">bullet</span>              </catnip-block>         <div class="catnip-block-Options"> <div class="catnip-block-anOptionsToggle"> <img src="/assets/icons/chevron-down.svg" class="feather"><span>Advanced</span> <img src="/assets/icons/chevron-down.svg" class="feather"> </div>    </div>       </catnip-block>
<catnip-block class=" command    selected">  <img src="/assets/icons/code-alt.svg" class="feather"><span class="catnip-block-aTextLabel">Set</span>         <catnip-block class=" computed wildcard wildcard userdefined ">  <img src="/assets/icons/clock.svg" class="feather"> <span class="catnip-block-aTextLabel">dir</span>              </catnip-block>  <span class="catnip-block-aTextLabel">value</span>                  <catnip-block class=" computed number wildcard  ">  <img src="/assets/icons/move.svg" class="feather"><span class="catnip-block-aTextLabel">direction</span>     </catnip-block>      </catnip-block>
<catnip-block class=" command void   selected">  <img src="/assets/icons/template.svg" class="feather"><span class="catnip-block-aTextLabel">With copy</span>         <catnip-block class=" computed wildcard wildcard userdefined ">  <img src="/assets/icons/clock.svg" class="feather"> <span class="catnip-block-aTextLabel">bullet</span>              </catnip-block>        <div class="catnip-block-Blocks"> <catnip-block-list>   <catnip-block class=" command    ">  <img src="/assets/icons/move.svg" class="feather"><span class="catnip-block-aTextLabel">Set direction to</span>         <catnip-block class=" computed wildcard number userdefined ">  <img src="/assets/icons/clock.svg" class="feather"> <span class="catnip-block-aTextLabel">dir</span>              </catnip-block>      </catnip-block>    </catnip-block-list> </div>        </catnip-block>

Вы также можете изменить свойства созданных копий непосредственно в блоке "Копировать шаблон" с помощью панели "Дополнительно":

<catnip-block class=" command    selected">  <img src="/assets/icons/template.svg" class="feather"><span class="catnip-block-aTextLabel">Copy a template</span>          <span class="catnip-block-aConstantInput menu string ">   <img src="/assets/icons/image.svg" class="feather"><span>Bullet</span></span>         <catnip-block class=" computed number number  ">  <img src="/assets/icons/move.svg" class="feather"><span class="catnip-block-aTextLabel">x</span>     </catnip-block>          <catnip-block class=" computed number number  ">  <img src="/assets/icons/move.svg" class="feather"><span class="catnip-block-aTextLabel">y</span>     </catnip-block>    <div class="catnip-block-aFiller"></div>        <span class="catnip-block-aTextLabel">store in</span>                  <catnip-block class=" computed wildcard wildcard userdefined ">  <img src="/assets/icons/clock.svg" class="feather"> <span class="catnip-block-aTextLabel">bullet</span>              </catnip-block>         <div class="catnip-block-Options"> <div class="catnip-block-anOptionsToggle"> <img src="/assets/icons/chevron-up.svg" class="feather"><span>Advanced</span> <img src="/assets/icons/chevron-up.svg" class="feather"> </div>  <dl> <dt> <input type="text" class="catnip-block-aConstantInput string " value="direction" style="width: 9.5ch" readonly="readonly"> </dt> <dd> <div class="toright anActionableIcon"> <img src="/assets/icons/delete.svg" class="feather"> </div> <catnip-block class=" computed number   ">  <img src="/assets/icons/move.svg" class="feather"><span class="catnip-block-aTextLabel">direction</span>     </catnip-block>  </dd> </dl> <div class="pad"> <button class="inline small"> <img src="/assets/icons/plus.svg" class="feather"><span>Add a custom property</span> </button> </div> </div>       </catnip-block>

Хранение ссылки полезно в том случае, если вам нужно изменить копию через некоторое время. Например, в аркадной игре-стрелялке с космическими кораблями вам может понадобиться уничтожить все летающие турели, которые следуют за вашим персонажем:

<catnip-block class=" command   note selected">  <img src="/assets/icons/message-circle.svg" class="feather"><span class="catnip-block-aTextLabel">Note</span>      <textarea value="Creating a turret. (A collision event with a bonus, for example.)" style="height: 21px;" readonly="readonly"></textarea>         </catnip-block>
<catnip-block class=" command    selected">  <img src="/assets/icons/template.svg" class="feather"><span class="catnip-block-aTextLabel">Copy a template</span>          <span class="catnip-block-aConstantInput menu string ">   <img src="/assets/icons/image.svg" class="feather"><span>SmallTurret</span></span>         <catnip-block class=" computed number number  ">           <catnip-block class=" computed number number  ">  <img src="/assets/icons/move.svg" class="feather"><span class="catnip-block-aTextLabel">x</span>     </catnip-block>  <span class="catnip-block-aTextLabel">+</span>                   <input type="text" class="catnip-block-aConstantInput number " style=" width: 3.5ch;    " value="100" readonly="readonly">     </catnip-block>          <catnip-block class=" computed number number  ">  <img src="/assets/icons/move.svg" class="feather"><span class="catnip-block-aTextLabel">y</span>     </catnip-block>    <div class="catnip-block-aFiller"></div>        <span class="catnip-block-aTextLabel">store in</span>                  <catnip-block class=" computed wildcard wildcard userdefined ">  <img src="/assets/icons/clock.svg" class="feather"> <span class="catnip-block-aTextLabel">rightTurret</span>              </catnip-block>         <div class="catnip-block-Options"> <div class="catnip-block-anOptionsToggle"> <img src="/assets/icons/chevron-down.svg" class="feather"><span>Advanced</span> <img src="/assets/icons/chevron-down.svg" class="feather"> </div>    </div>       </catnip-block>
<catnip-block class=" command   note selected">  <img src="/assets/icons/message-circle.svg" class="feather"><span class="catnip-block-aTextLabel">Note</span>      <textarea value="In Destruction event…" style="height: 21px;" readonly="readonly"></textarea>         </catnip-block>
<catnip-block class=" command    selected">  <img src="/assets/icons/help-circle.svg" class="feather"><span class="catnip-block-aTextLabel">If</span>         <catnip-block class=" computed boolean boolean  ">  <img src="/assets/icons/template.svg" class="feather"><span class="catnip-block-aTextLabel">is valid</span>         <catnip-block class=" computed wildcard wildcard userdefined ">  <img src="/assets/icons/clock.svg" class="feather"> <span class="catnip-block-aTextLabel">rightTurret</span>              </catnip-block>      </catnip-block>        <div class="catnip-block-Blocks"> <catnip-block-list>   <catnip-block class=" command void   ">  <img src="/assets/icons/template.svg" class="feather"><span class="catnip-block-aTextLabel">With copy</span>         <catnip-block class=" computed wildcard wildcard userdefined ">  <img src="/assets/icons/clock.svg" class="feather"> <span class="catnip-block-aTextLabel">rightTurret</span>              </catnip-block>        <div class="catnip-block-Blocks"> <catnip-block-list>   <catnip-block class=" command    ">  <img src="/assets/icons/template.svg" class="feather"><span class="catnip-block-aTextLabel">Destroy this copy</span>     </catnip-block>    </catnip-block-list> </div>        </catnip-block>    </catnip-block-list> </div>        </catnip-block>

### Влияние затронутых копий при столкновениях

События столкновения предоставляют специальную переменную события (вставьте блок переменной здесь), которую можно объединить с блоком "С копией". Например, это может быть написано в событии шаблона проекции, когда она сталкивается с врагом:

<catnip-block class=" command void   selected">  <img src="/assets/icons/template.svg" class="feather"><span class="catnip-block-aTextLabel">With copy</span>         <catnip-block class=" computed wildcard wildcard userdefined ">  <img src="/assets/icons/bell.svg" class="feather"> <span class="catnip-block-aTextLabel">other</span>              </catnip-block>        <div class="catnip-block-Blocks"> <catnip-block-list>   <catnip-block class=" command    ">  <img src="/assets/icons/minus-circle.svg" class="feather"><span class="catnip-block-aTextLabel">Decrease</span>         <catnip-block class=" computed wildcard wildcard  ">  <img src="/assets/icons/code-alt.svg" class="feather"><span class="catnip-block-aTextLabel">read</span>          <input type="text" class="catnip-block-aConstantInput string " value="hp" style=" width: 2.5ch;    " readonly="readonly">     </catnip-block>  <span class="catnip-block-aTextLabel">by</span>                   <input type="text" class="catnip-block-aConstantInput number " value="12" style=" width: 2.5ch;    " readonly="readonly">     </catnip-block>   <catnip-block class=" command    ">  <img src="/assets/icons/help-circle.svg" class="feather"><span class="catnip-block-aTextLabel">If</span>         <catnip-block class=" computed boolean boolean  ">           <catnip-block class=" computed wildcard number  ">  <img src="/assets/icons/code-alt.svg" class="feather"><span class="catnip-block-aTextLabel">read</span>          <input type="text" class="catnip-block-aConstantInput string " value="hp" style=" width: 2.5ch;    " readonly="readonly">     </catnip-block>  <span class="catnip-block-aTextLabel">≤</span>                   <input type="text" class="catnip-block-aConstantInput number " value="0" style=" width: 1.5ch;    " readonly="readonly">     </catnip-block>        <div class="catnip-block-Blocks"> <catnip-block-list>   <catnip-block class=" command    ">  <img src="/assets/icons/template.svg" class="feather"><span class="catnip-block-aTextLabel">Destroy this copy</span>     </catnip-block>    </catnip-block-list> </div>        </catnip-block>    </catnip-block-list> </div>        </catnip-block>
<catnip-block class=" command   note selected">  <img src="/assets/icons/message-circle.svg" class="feather"><span class="catnip-block-aTextLabel">Note</span>      <textarea value="Destroy the projectile itself" style="height: 21px;" readonly="readonly"></textarea>         </catnip-block>
<catnip-block class=" command    selected">  <img src="/assets/icons/template.svg" class="feather"><span class="catnip-block-aTextLabel">Destroy this copy</span>     </catnip-block>

## Что дальше?

Если вы уже читали другие страницы в категории "Обучение Catnip", ваш следующий шаг - завершить руководства! Они покажут, как применить полученные знания на практике и как работать с движком. Попробуйте эти:

* [Создание космического шутера](../tutorials/making-games-shooter.md)
* [Создание платформера](../tutorials/making-games-platformer.md)
* [Создание игры Flappy Bird, подобной JettyCat](../tutorials/making-games-jettycat.md)

